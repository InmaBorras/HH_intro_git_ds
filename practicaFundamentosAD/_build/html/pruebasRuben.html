
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Práctica de Fundamentos de Análisis de Datos</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/HH-Logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Práctica de Fundamentos de Análisis de Datos</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1-DefinicionObjetivos.html">
   1.  Introducción.
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="2-AnalisisExploratorioInicial.html">
   2. Análisis Exploratorio Inicial (EDA)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-TransformacionVariablesCuantitativas.html">
   3. Variables Cuantitativas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4-ProcesamientoVaribalesCualitativas.html">
   4.Variables Cualitativas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5-DeteccionImputacionDatosFaltantes.html">
   5. Limpieza de los datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6-SelecciondeVariables.html">
   6.  Variables seleccionadas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7-AjusteDelModelosdeRegresionLineal.html">
   7.Ajuste del Modelo
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/pruebasRuben.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FpruebasRuben.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/pruebasRuben.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="simple nav section-nav flex-column">
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default=&#39;warn&#39;</span>
<span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">aes</span><span class="p">,</span> <span class="n">geom_line</span><span class="p">,</span> <span class="n">geom_point</span><span class="p">,</span> <span class="n">geom_bar</span><span class="p">,</span> <span class="n">geom_boxplot</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/ruben/tmp/HH_intro_git_ds/precios_casas_sinduplicados.csv&#39;</span><span class="p">)</span>
<span class="n">dataframe_old</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/ruben/tmp/HH_intro_git_ds/Melbourne_housing_FULL.csv&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">ss</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>
<span class="kn">from</span> <span class="nn">seaborn</span> <span class="kn">import</span> <span class="n">kdeplot</span>
<span class="c1"># Tratamiento de datos</span>
<span class="c1"># ==============================================================================</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Gráficos</span>
<span class="c1"># ==============================================================================</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Preprocesado y modelado</span>
<span class="c1"># ==============================================================================</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.anova</span> <span class="kn">import</span> <span class="n">anova_lm</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Configuración matplotlib</span>
<span class="c1"># ==============================================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bwr&quot;</span>
<span class="c1">#plt.rcParams[&#39;figure.dpi&#39;] = &quot;100&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.bbox&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
<span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="c1"># Configuración warnings</span>
<span class="c1"># ==============================================================================</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="k">def</span> <span class="nf">quartile_skew</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">])</span> 
  <span class="k">return</span> <span class="p">((</span><span class="n">q</span><span class="p">[</span><span class="mf">0.75</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mf">0.5</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mf">0.25</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mf">0.75</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mf">0.25</span><span class="p">])</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dataframe_old</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">duplicateRowsDF</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">duplicateRowsDF</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="o">.</span><span class="n">duplicated</span><span class="p">([</span><span class="s1">&#39;Suburb&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">,</span><span class="s1">&#39;Postcode&#39;</span><span class="p">,</span><span class="s1">&#39;CouncilArea&#39;</span><span class="p">,],</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
<span class="n">duplicateRowsDF</span><span class="o">=</span><span class="n">duplicateRowsDF</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">duplicateRowsDF</span><span class="o">=</span><span class="n">duplicateRowsDF</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>
<span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span><span class="s1">&#39;Suburb&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duplicateRowsDF</span><span class="p">)</span>
<span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>
<span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="c1">#dataframe[&#39;Price&#39;]=dataframe[&#39;Price&#39;].replace(0, 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataframe_old</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">])</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">])</span>


<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">)</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s2">&quot;Landsize&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)))</span>    
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">])</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">])</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">])</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">])</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Landsize&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="o">=</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;BathAndRooms&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s2">&quot;Rooms&quot;</span><span class="p">]</span><span class="o">+</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s2">&quot;Bathroom&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">])</span>
<span class="n">dataframe_filtered</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           Suburb           Address  Rooms Type      Price Method  \
0      Abbotsford      85 Turner St      2    h  1480000.0      S   
1      Abbotsford   25 Bloomburg St      2    h  1035000.0      S   
2      Abbotsford      5 Charles St      3    h  1465000.0     SP   
3      Abbotsford  40 Federation La      3    h   850000.0     PI   
4      Abbotsford       55a Park St      4    h  1600000.0     VB   
...           ...               ...    ...  ...        ...    ...   
26543  Yarraville       13 Burns St      4    h  1480000.0     PI   
26544  Yarraville     29A Murray St      2    h   888000.0     SP   
26545  Yarraville    147A Severn St      2    t   705000.0      S   
26546  Yarraville  12/37 Stephen St      3    h  1140000.0     SP   
26547  Yarraville  3 Tarrengower St      2    h  1020000.0     PI   

             SellerG        Date  Distance  Postcode  Bathroom  Car  Landsize  \
0             Biggin   3/12/2016       2.5    3067.0       1.0  1.0     202.0   
1             Biggin   4/02/2016       2.5    3067.0       1.0  0.0     156.0   
2             Biggin   4/03/2017       2.5    3067.0       2.0  0.0     134.0   
3             Biggin   4/03/2017       2.5    3067.0       2.0  1.0      94.0   
4             Nelson   4/06/2016       2.5    3067.0       1.0  2.0     120.0   
...              ...         ...       ...       ...       ...  ...       ...   
26543            Jas  24/02/2018       6.3    3013.0       1.0  3.0     593.0   
26544        Sweeney  24/02/2018       6.3    3013.0       2.0  1.0      98.0   
26545            Jas  24/02/2018       6.3    3013.0       1.0  2.0     220.0   
26546  hockingstuart  24/02/2018       6.3    3013.0       1.0  1.0     211.0   
26547             RW  24/02/2018       6.3    3013.0       1.0  0.0     250.0   

                    CouncilArea  Lattitude  Longtitude             Regionname  \
0            Yarra City Council  -37.79960   144.99840  Northern Metropolitan   
1            Yarra City Council  -37.80790   144.99340  Northern Metropolitan   
2            Yarra City Council  -37.80930   144.99440  Northern Metropolitan   
3            Yarra City Council  -37.79690   144.99690  Northern Metropolitan   
4            Yarra City Council  -37.80720   144.99410  Northern Metropolitan   
...                         ...        ...         ...                    ...   
26543  Maribyrnong City Council  -37.81053   144.88467   Western Metropolitan   
26544  Maribyrnong City Council  -37.81551   144.88826   Western Metropolitan   
26545  Maribyrnong City Council  -37.82286   144.87856   Western Metropolitan   
26546  Maribyrnong City Council   -8.03276     0.00000   Western Metropolitan   
26547  Maribyrnong City Council  -37.81810   144.89351   Western Metropolitan   

       Propertycount  
0             4019.0  
1             4019.0  
2             4019.0  
3             4019.0  
4             4019.0  
...              ...  
26543         6543.0  
26544         6543.0  
26545         6543.0  
26546         6543.0  
26547         6543.0  

[26548 rows x 18 columns]
Suburb            object
Address           object
Rooms              int64
Type              object
Price            float64
Method            object
SellerG           object
Date              object
Distance         float64
Postcode         float64
Bedroom2         float64
Bathroom         float64
Car              float64
Landsize         float64
BuildingArea     float64
YearBuilt        float64
CouncilArea       object
Lattitude        float64
Longtitude       float64
Regionname        object
Propertycount    float64
dtype: object
           Suburb           Address     Rooms Type      Price Method  \
0      Abbotsford      85 Turner St  1.414214    h  1480000.0      S   
1      Abbotsford   25 Bloomburg St  1.414214    h  1035000.0      S   
2      Abbotsford      5 Charles St  1.732051    h  1465000.0     SP   
3      Abbotsford  40 Federation La  1.732051    h   850000.0     PI   
4      Abbotsford       55a Park St  2.000000    h  1600000.0     VB   
...           ...               ...       ...  ...        ...    ...   
26543  Yarraville       13 Burns St  2.000000    h  1480000.0     PI   
26544  Yarraville     29A Murray St  1.414214    h   888000.0     SP   
26545  Yarraville    147A Severn St  1.414214    t   705000.0      S   
26546  Yarraville  12/37 Stephen St  1.732051    h  1140000.0     SP   
26547  Yarraville  3 Tarrengower St  1.414214    h  1020000.0     PI   

             SellerG        Date  Distance  Postcode  Bathroom  Car  Landsize  \
0             Biggin   3/12/2016  1.581139    3067.0       1.0  1.0     202.0   
1             Biggin   4/02/2016  1.581139    3067.0       1.0  0.0     156.0   
2             Biggin   4/03/2017  1.581139    3067.0       2.0  0.0     134.0   
3             Biggin   4/03/2017  1.581139    3067.0       2.0  1.0      94.0   
4             Nelson   4/06/2016  1.581139    3067.0       1.0  2.0     120.0   
...              ...         ...       ...       ...       ...  ...       ...   
26543            Jas  24/02/2018  2.509980    3013.0       1.0  3.0     593.0   
26544        Sweeney  24/02/2018  2.509980    3013.0       2.0  1.0      98.0   
26545            Jas  24/02/2018  2.509980    3013.0       1.0  2.0     220.0   
26546  hockingstuart  24/02/2018  2.509980    3013.0       1.0  1.0     211.0   
26547             RW  24/02/2018  2.509980    3013.0       1.0  0.0     250.0   

                    CouncilArea  Lattitude  Longtitude             Regionname  \
0            Yarra City Council  -37.79960   144.99840  Northern Metropolitan   
1            Yarra City Council  -37.80790   144.99340  Northern Metropolitan   
2            Yarra City Council  -37.80930   144.99440  Northern Metropolitan   
3            Yarra City Council  -37.79690   144.99690  Northern Metropolitan   
4            Yarra City Council  -37.80720   144.99410  Northern Metropolitan   
...                         ...        ...         ...                    ...   
26543  Maribyrnong City Council  -37.81053   144.88467   Western Metropolitan   
26544  Maribyrnong City Council  -37.81551   144.88826   Western Metropolitan   
26545  Maribyrnong City Council  -37.82286   144.87856   Western Metropolitan   
26546  Maribyrnong City Council   -8.03276     1.00000   Western Metropolitan   
26547  Maribyrnong City Council  -37.81810   144.89351   Western Metropolitan   

       Propertycount  
0             4019.0  
1             4019.0  
2             4019.0  
3             4019.0  
4             4019.0  
...              ...  
26543         6543.0  
26544         6543.0  
26545         6543.0  
26546         6543.0  
26547         6543.0  

[26300 rows x 18 columns]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Price</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Lattitude</th>
      <th>Longtitude</th>
      <th>Propertycount</th>
      <th>BathAndRooms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26240.000000</td>
      <td>26238.000000</td>
      <td>26240.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.710789</td>
      <td>2.441154</td>
      <td>3.237989</td>
      <td>3114.557470</td>
      <td>1.488491</td>
      <td>1.583537</td>
      <td>5.555090</td>
      <td>-30.161956</td>
      <td>3.864349</td>
      <td>2.164320</td>
      <td>1.825953</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.273295</td>
      <td>0.045262</td>
      <td>0.962917</td>
      <td>111.957301</td>
      <td>0.649195</td>
      <td>0.917681</td>
      <td>1.693516</td>
      <td>14.355712</td>
      <td>2.073337</td>
      <td>0.078571</td>
      <td>0.516985</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>2.220229</td>
      <td>0.836660</td>
      <td>3000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-38.190430</td>
      <td>0.000000</td>
      <td>1.485877</td>
      <td>0.464398</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.414214</td>
      <td>2.409602</td>
      <td>2.549510</td>
      <td>3046.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>5.393628</td>
      <td>-37.843735</td>
      <td>4.974961</td>
      <td>2.124053</td>
      <td>1.441589</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.732051</td>
      <td>2.437471</td>
      <td>3.240370</td>
      <td>3088.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>6.025866</td>
      <td>-37.772200</td>
      <td>4.976510</td>
      <td>2.173593</td>
      <td>1.717686</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>2.472301</td>
      <td>3.768289</td>
      <td>3156.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>6.429719</td>
      <td>-37.642112</td>
      <td>4.977075</td>
      <td>2.223856</td>
      <td>2.106562</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.162278</td>
      <td>2.655036</td>
      <td>6.935416</td>
      <td>3978.000000</td>
      <td>4.000000</td>
      <td>18.000000</td>
      <td>12.978525</td>
      <td>0.000000</td>
      <td>4.980357</td>
      <td>2.300860</td>
      <td>5.640373</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># División de los datos en train y test</span>
<span class="c1"># ==============================================================================</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dataframe_filtered</span><span class="p">[[</span><span class="s1">&#39;BathAndRooms&#39;</span><span class="p">,</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span> <span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span> <span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataframe_filtered</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
                                        <span class="n">X</span><span class="p">,</span>
                                        <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                                        <span class="n">train_size</span>   <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
                                        <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">,</span>
                                        <span class="n">shuffle</span>      <span class="o">=</span> <span class="kc">True</span>
                                    <span class="p">)</span>

<span class="c1"># Creación del modelo utilizando el modo fórmula (similar a R)</span>
<span class="c1"># ==============================================================================</span>
<span class="sd">&#39;&#39;&#39;datos_train = pd.DataFrame(</span>
<span class="sd">                     np.hstack((X_train, y_train)),</span>
<span class="sd">                     columns=[&#39;Rooms&#39;, &#39;Bathroom&#39;, &#39;Distance&#39;, &#39;Price&#39;]</span>
<span class="sd">               )</span>
<span class="sd">modelo = smf.ols(formula = &#39;Price ~ BathAndRooms&#39;, data = datos_train)</span>
<span class="sd">modelo = modelo.fit()</span>
<span class="sd">print(modelo.summary())</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Creación del modelo utilizando matrices como en scikitlearn</span>
<span class="c1"># ==============================================================================</span>
<span class="c1"># A la matriz de predictores se le tiene que añadir una columna de 1s para el intercept del modelo</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">modelo</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">X_train</span><span class="p">,)</span>
<span class="n">modelo</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>


<span class="c1"># Intervalos de confianza para los coeficientes del modelo</span>
<span class="c1"># ==============================================================================</span>
<span class="n">intervalos_ci</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">intervalos_ci</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2.5%&#39;</span><span class="p">,</span> <span class="s1">&#39;97.5%&#39;</span><span class="p">]</span>
<span class="n">intervalos_ci</span>




<span class="c1"># Diagnóstico errores (residuos) de las predicciones de entrenamiento</span>
<span class="c1"># ==============================================================================</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">prediccion_train</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">exog</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">)</span>
<span class="n">residuos_train</span>   <span class="o">=</span> <span class="n">prediccion_train</span> <span class="o">-</span> <span class="n">y_train</span>

<span class="c1"># Gráficos</span>
<span class="c1"># ==============================================================================</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">prediccion_train</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">y_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="p">[</span><span class="n">y_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
                <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Valor predicho vs valor real&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicción&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">))),</span> <span class="n">residuos_train</span><span class="p">,</span>
                   <span class="n">edgecolors</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuos del modelo&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span>    <span class="o">=</span> <span class="n">residuos_train</span><span class="p">,</span>
    <span class="n">stat</span>    <span class="o">=</span> <span class="s2">&quot;density&quot;</span><span class="p">,</span>
    <span class="n">kde</span>     <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">line_kws</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="n">color</span>   <span class="o">=</span> <span class="s2">&quot;firebrick&quot;</span><span class="p">,</span>
    <span class="n">alpha</span>   <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="n">ax</span>      <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribución residuos del modelo&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                     <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residuo&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>


<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span>
    <span class="n">residuos_train</span><span class="p">,</span>
    <span class="n">fit</span>   <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">line</span>  <span class="o">=</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span>
    <span class="n">ax</span>    <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;firebrick&#39;</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">lw</span>    <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q-Q residuos del modelo&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">prediccion_train</span><span class="p">,</span> <span class="n">residuos_train</span><span class="p">,</span>
                   <span class="n">edgecolors</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuos del modelo vs predicción&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicción&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>

<span class="c1"># Se eliminan los axes vacíos</span>
<span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Diagnóstico residuos&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s2">&quot;bold&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.506
Model:                            OLS   Adj. R-squared:                  0.505
Method:                 Least Squares   F-statistic:                     3576.
Date:                Sat, 19 Dec 2020   Prob (F-statistic):               0.00
Time:                        22:26:34   Log-Likelihood:                 42513.
No. Observations:               20992   AIC:                        -8.501e+04
Df Residuals:                   20985   BIC:                        -8.496e+04
Df Model:                           6                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
const            2.3126      0.003    924.894      0.000       2.308       2.318
BathAndRooms     0.0170      0.002      8.304      0.000       0.013       0.021
Rooms            0.0661      0.002     40.496      0.000       0.063       0.069
Bathroom         0.0018      0.001      1.441      0.149      -0.001       0.004
Distance        -0.0180      0.001    -27.802      0.000      -0.019      -0.017
Landsize         0.0068      0.000     44.565      0.000       0.006       0.007
Longtitude       0.0006      0.000      5.877      0.000       0.000       0.001
==============================================================================
Omnibus:                      214.296   Durbin-Watson:                   1.990
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              237.214
Skew:                           0.210   Prob(JB):                     3.09e-52
Kurtosis:                       3.308   Cond. No.                         129.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<img alt="_images/pruebasRuben_1_1.png" src="_images/pruebasRuben_1_1.png" />
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Inmaculada Borrás , Jose María Melero y Rubén Valle<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>